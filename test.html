<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test API</title>
</head>
<body>
    <h1>Test de l'API</h1>
    <div id="status"></div>
    <div id="results"></div>

    <script type="module">
        const status = document.getElementById('status');
        const results = document.getElementById('results');
        
        async function testAPI() {
            status.innerHTML = 'Test en cours...';
            
            try {
                // Test 1: Films populaires
                console.log('Test 1: Films populaires');
                const response1 = await fetch('/api/movies?endpoint=trending&page=1');
                const data1 = await response1.json();
                console.log('Trending movies:', data1);
                
                // Test 2: Détails d'un film
                console.log('Test 2: Détails film');
                const response2 = await fetch('/api/movies?endpoint=movie&id=299536');
                const data2 = await response2.json();
                console.log('Movie details:', data2);
                
                // Test 3: Recherche
                console.log('Test 3: Recherche');
                const response3 = await fetch('/api/movies?endpoint=search&query=batman');
                const data3 = await response3.json();
                console.log('Search results:', data3);
                
                status.innerHTML = '✅ Tous les tests réussis !';
                results.innerHTML = `
                    <p><strong>Films populaires:</strong> ${data1.results?.length || 0} films</p>
                    <p><strong>Film détail:</strong> ${data2.title || 'N/A'}</p>
                    <p><strong>Recherche Batman:</strong> ${data3.results?.length || 0} résultats</p>
                `;
                
            } catch (error) {
                console.error('Erreur:', error);
                status.innerHTML = '❌ Erreur: ' + error.message;
                results.innerHTML = '<p>Voir la console pour plus de détails</p>';
            }
        }
        
        // Tester automatiquement au chargement
        testAPI();
    </script>
</body>
</html>